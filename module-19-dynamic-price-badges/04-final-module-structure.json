{
  "title": "Dynamic Price Badges",
  "description": "Dynamic product price badges with discount percentage, compare at price, and cart discount preview. Includes Shopify Liquid integration.",
  "longDescription": "A fully functional dynamic price badge system that displays product discount percentages, compare-at prices, current prices, and cart discount previews. Automatically fetches real prices from Shopify Liquid templates with fallback demo prices for preview environments. Features persistent display enforcement, variant change detection, and responsive design.",
  "thumbnail": "/modules/cover/LIQUIDFY-Dynamic-Price-Badges-cover.png",
  "images": [
    "/modules/cover/LIQUIDFY-Dynamic-Price-Badges-cover.png"
  ],
  "category": "Pricing",
  "tags": [
    "Price",
    "Discount",
    "Badges",
    "Dynamic",
    "Cart",
    "Shopify"
  ],
  "featured": false,
  "status": "published",
  "code": "<!-- MODULE: Dynamic Price Badges --><div class=\"dynamic-price-module\"><div class=\"product-price-badges\"><div class=\"product-top-line\"><span class=\"product-discount\" id=\"discount-badge\"></span><span class=\"product-old\" id=\"compare-price\"></span><span class=\"product-new\" id=\"current-price\"></span></div><div class=\"product-cart-badge\" id=\"cart-badge\"></div></div></div><!-- Inject product data via Liquid as JavaScript variable (AFTER HTML) --><script>window.liquidProductData = {currentPrice: {{ product.selected_or_first_available_variant.price | divided_by: 100.0 }},comparePrice: {% if product.selected_or_first_available_variant.compare_at_price %}{{ product.selected_or_first_available_variant.compare_at_price | divided_by: 100.0 }}{% else %}null{% endif %},variants: [{% for variant in product.variants %}{id: {{ variant.id }},price: {{ variant.price | divided_by: 100.0 }},comparePrice: {% if variant.compare_at_price %}{{ variant.compare_at_price | divided_by: 100.0 }}{% else %}null{% endif %}}{% unless forloop.last %},{% endunless %}{% endfor %}]};if (typeof initDynamicPriceBadges === 'function') {initDynamicPriceBadges();}</script><style>* {box-sizing: border-box;margin: 0;padding: 0;}.dynamic-price-module {width: 100%;font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;}.product-price-badges {max-width: 320px;width: 100%;}.product-top-line {display: flex;align-items: center;gap: 8px;flex-wrap: nowrap;}.product-discount {background-color: #c73225;color: #fff;font-weight: 600;padding: 4px 8px;border-radius: 5px;font-size: 12px;flex-shrink: 0;}.product-old {color: #a0a0a0;text-decoration: line-through;font-size: 14px;flex-shrink: 0;}.product-new {color: #000;font-weight: 700;font-size: 18px;}.product-cart-badge {background-color: #c73225;color: #fff;font-weight: 600;padding: 6px 10px;border-radius: 6px;font-size: 13px;margin-top: 8px;text-align: left;line-height: 1;white-space: nowrap;display: inline-block;}.product-cart-badge.hidden {display: none;}@media (max-width: 480px) {.product-top-line {gap: 5px;}.product-discount {font-size: 11px;padding: 3px 6px;}.product-old {font-size: 12px;}.product-new {font-size: 15px;}.product-cart-badge {font-size: 12px;padding: 5px 8px;border-radius: 5px;}}</style><script>function initDynamicPriceBadges() {const config = {cartDiscountPercent: 10,cartDiscountMessage: 'Extra',cartDiscountSuffix: 'Off in Cart',showCartBadge: true,currencySymbol: '$',fallbackCurrentPrice: 24.00,fallbackComparePrice: 45.00,discountBadgeId: 'discount-badge',comparePriceId: 'compare-price',currentPriceId: 'current-price',cartBadgeId: 'cart-badge'};const discountBadge = document.getElementById(config.discountBadgeId);const comparePriceEl = document.getElementById(config.comparePriceId);const currentPriceEl = document.getElementById(config.currentPriceId);const cartBadgeEl = document.getElementById(config.cartBadgeId);if (!discountBadge || !comparePriceEl || !currentPriceEl || !cartBadgeEl) {console.error('Price badge elements not found');return;}function formatPrice(price, currency = config.currencySymbol) {return currency + price.toFixed(2);}function calculateDiscountPercent(comparePrice, currentPrice) {if (!comparePrice || comparePrice <= 0 || currentPrice >= comparePrice) {return 0;}const discount = ((comparePrice - currentPrice) / comparePrice) * 100;return Math.round(discount);}function calculateCartPrice(currentPrice, cartDiscountPercent) {const finalPrice = currentPrice * (1 - cartDiscountPercent / 100);return finalPrice;}function fetchProductDataFromPage() {let currentPrice = null;let compareAtPrice = null;if (typeof window.liquidProductData !== 'undefined' && window.liquidProductData) {if (window.liquidProductData.currentPrice && window.liquidProductData.currentPrice > 0) {currentPrice = window.liquidProductData.currentPrice;}if (window.liquidProductData.comparePrice && window.liquidProductData.comparePrice > 0) {compareAtPrice = window.liquidProductData.comparePrice;}}if (!currentPrice && typeof window.ShopifyAnalytics !== 'undefined' && window.ShopifyAnalytics.meta && window.ShopifyAnalytics.meta.product) {const product = window.ShopifyAnalytics.meta.product;if (product.variants && product.variants[0]) {const variant = product.variants[0];if (variant.price && variant.price > 0) {currentPrice = variant.price / 100;}if (variant.compare_at_price && variant.compare_at_price > 0) {compareAtPrice = variant.compare_at_price / 100;}}}if (currentPrice && currentPrice > 0) {return {currentPrice: currentPrice,compareAtPrice: compareAtPrice};}return null;}const productData = fetchProductDataFromPage();let currentPrice, compareAtPrice;if (productData && productData.currentPrice && productData.currentPrice > 0) {currentPrice = productData.currentPrice;compareAtPrice = productData.compareAtPrice || null;} else {currentPrice = config.fallbackCurrentPrice || 24.00;compareAtPrice = config.fallbackComparePrice || 45.00;}const discountPercent = calculateDiscountPercent(compareAtPrice, currentPrice);if (compareAtPrice && compareAtPrice > currentPrice && discountPercent > 0) {discountBadge.textContent = '-' + discountPercent + '%';discountBadge.style.setProperty('display', 'inline-block', 'important');discountBadge.style.setProperty('visibility', 'visible', 'important');comparePriceEl.textContent = formatPrice(compareAtPrice, config.currencySymbol);comparePriceEl.style.setProperty('display', 'inline-block', 'important');comparePriceEl.style.setProperty('visibility', 'visible', 'important');} else {discountBadge.style.setProperty('display', 'none', 'important');comparePriceEl.style.setProperty('display', 'none', 'important');}currentPriceEl.textContent = formatPrice(currentPrice, config.currencySymbol);if (config.showCartBadge && config.cartDiscountPercent > 0) {const cartFinalPrice = calculateCartPrice(currentPrice, config.cartDiscountPercent);const cartBadgeText = config.cartDiscountMessage + ' ' + config.cartDiscountPercent + '% ' + config.cartDiscountSuffix + ' ' + formatPrice(cartFinalPrice, config.currencySymbol);cartBadgeEl.textContent = cartBadgeText;} else {cartBadgeEl.classList.add('hidden');}}if (document.readyState === 'loading') {document.addEventListener('DOMContentLoaded', initDynamicPriceBadges);} else {initDynamicPriceBadges();}let forcedDisplayInterval = null;let forceAttempts = 0;const MAX_FORCE_ATTEMPTS = 6;function forceDisplayPersistent() {forceAttempts++;const discountBadge = document.getElementById('discount-badge');const comparePriceEl = document.getElementById('compare-price');if (!discountBadge || !comparePriceEl) return;if (window.liquidProductData && window.liquidProductData.comparePrice && window.liquidProductData.comparePrice > window.liquidProductData.currentPrice) {const currentDisplay = window.getComputedStyle(discountBadge).display;const compareDisplay = window.getComputedStyle(comparePriceEl).display;if (currentDisplay !== 'none' && compareDisplay !== 'none') {if (forcedDisplayInterval) {clearInterval(forcedDisplayInterval);forcedDisplayInterval = null;}return;}if (currentDisplay === 'none' || compareDisplay === 'none') {discountBadge.style.setProperty('display', 'inline-block', 'important');comparePriceEl.style.setProperty('display', 'inline-block', 'important');}}if (forceAttempts >= MAX_FORCE_ATTEMPTS && forcedDisplayInterval) {clearInterval(forcedDisplayInterval);forcedDisplayInterval = null;}}setTimeout(function() {forcedDisplayInterval = setInterval(forceDisplayPersistent, 200);}, 100);function updatePricesFromVariant(variant) {if (window.liquidProductData && window.liquidProductData.variants) {const liquidVariant = window.liquidProductData.variants.find(function(v) { return v.id === variant.id; });if (liquidVariant) {variant = liquidVariant;}}let currentPrice = null;let compareAtPrice = null;if (variant.price) {currentPrice = typeof variant.price === 'number' ? variant.price : variant.price / 100;}if (variant.comparePrice) {compareAtPrice = variant.comparePrice;} else if (variant.compare_at_price && variant.compare_at_price > 0) {compareAtPrice = variant.compare_at_price / 100;}if (window.liquidProductData) {window.liquidProductData.currentPrice = currentPrice;window.liquidProductData.comparePrice = compareAtPrice;}initDynamicPriceBadges();}document.addEventListener('variant:change', function(event) {if (event.detail && event.detail.variant) {updatePricesFromVariant(event.detail.variant);}});document.addEventListener('variantChange', function(event) {if (event.detail && event.detail.variant) {updatePricesFromVariant(event.detail.variant);}});document.body.addEventListener('change', function(event) {if (event.target.matches('select[name=\"id\"], input[name=\"id\"], input[type=\"radio\"][name*=\"option\"]')) {setTimeout(function() {let selectedVariant = null;if (window.product && window.product.selected_or_first_available_variant) {selectedVariant = window.product.selected_or_first_available_variant;}if (!selectedVariant) {const variantIdInput = document.querySelector('select[name=\"id\"], input[name=\"id\"]');if (variantIdInput) {const variantId = parseInt(variantIdInput.value);if (window.ShopifyAnalytics && window.ShopifyAnalytics.meta && window.ShopifyAnalytics.meta.product) {const product = window.ShopifyAnalytics.meta.product;if (product.variants) {selectedVariant = product.variants.find(function(v) { return v.id === variantId; });}}}}if (selectedVariant) {updatePricesFromVariant(selectedVariant);}}, 100);}});</script>",
  "slug": "dynamic-price-badges",
  "createdAt": { "$date": "2025-10-27T16:00:00.000Z" },
  "updatedAt": { "$date": "2025-10-27T16:00:00.000Z" },
  "originalTitle": "Dynamic Price Badges",
  "downloads": 0,
  "lastVariableUpdate": { "$date": "2025-10-27T16:00:00.000Z" },
  "variableCount": 8,
  "content": "<!-- MODULE: Dynamic Price Badges --><div class=\"dynamic-price-module\"><div class=\"product-price-badges\"><div class=\"product-top-line\"><span class=\"product-discount\" id=\"discount-badge\"></span><span class=\"product-old\" id=\"compare-price\"></span><span class=\"product-new\" id=\"current-price\"></span></div><div class=\"product-cart-badge\" id=\"cart-badge\"></div></div></div><!-- Inject product data via Liquid as JavaScript variable (AFTER HTML) --><script>window.liquidProductData = {currentPrice: {{ product.selected_or_first_available_variant.price | divided_by: 100.0 }},comparePrice: {% if product.selected_or_first_available_variant.compare_at_price %}{{ product.selected_or_first_available_variant.compare_at_price | divided_by: 100.0 }}{% else %}null{% endif %},variants: [{% for variant in product.variants %}{id: {{ variant.id }},price: {{ variant.price | divided_by: 100.0 }},comparePrice: {% if variant.compare_at_price %}{{ variant.compare_at_price | divided_by: 100.0 }}{% else %}null{% endif %}}{% unless forloop.last %},{% endunless %}{% endfor %}]};if (typeof initDynamicPriceBadges === 'function') {initDynamicPriceBadges();}</script><style>* {box-sizing: border-box;margin: 0;padding: 0;}.dynamic-price-module {width: 100%;font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;}.product-price-badges {max-width: 320px;width: 100%;}.product-top-line {display: flex;align-items: center;gap: 8px;flex-wrap: nowrap;}.product-discount {background-color: #c73225;color: #fff;font-weight: 600;padding: 4px 8px;border-radius: 5px;font-size: 12px;flex-shrink: 0;}.product-old {color: #a0a0a0;text-decoration: line-through;font-size: 14px;flex-shrink: 0;}.product-new {color: #000;font-weight: 700;font-size: 18px;}.product-cart-badge {background-color: #c73225;color: #fff;font-weight: 600;padding: 6px 10px;border-radius: 6px;font-size: 13px;margin-top: 8px;text-align: left;line-height: 1;white-space: nowrap;display: inline-block;}.product-cart-badge.hidden {display: none;}@media (max-width: 480px) {.product-top-line {gap: 5px;}.product-discount {font-size: 11px;padding: 3px 6px;}.product-old {font-size: 12px;}.product-new {font-size: 15px;}.product-cart-badge {font-size: 12px;padding: 5px 8px;border-radius: 5px;}}</style><script>function initDynamicPriceBadges() {const config = {cartDiscountPercent: 10,cartDiscountMessage: 'Extra',cartDiscountSuffix: 'Off in Cart',showCartBadge: true,currencySymbol: '$',fallbackCurrentPrice: 24.00,fallbackComparePrice: 45.00,discountBadgeId: 'discount-badge',comparePriceId: 'compare-price',currentPriceId: 'current-price',cartBadgeId: 'cart-badge'};const discountBadge = document.getElementById(config.discountBadgeId);const comparePriceEl = document.getElementById(config.comparePriceId);const currentPriceEl = document.getElementById(config.currentPriceId);const cartBadgeEl = document.getElementById(config.cartBadgeId);if (!discountBadge || !comparePriceEl || !currentPriceEl || !cartBadgeEl) {console.error('Price badge elements not found');return;}function formatPrice(price, currency = config.currencySymbol) {return currency + price.toFixed(2);}function calculateDiscountPercent(comparePrice, currentPrice) {if (!comparePrice || comparePrice <= 0 || currentPrice >= comparePrice) {return 0;}const discount = ((comparePrice - currentPrice) / comparePrice) * 100;return Math.round(discount);}function calculateCartPrice(currentPrice, cartDiscountPercent) {const finalPrice = currentPrice * (1 - cartDiscountPercent / 100);return finalPrice;}function fetchProductDataFromPage() {let currentPrice = null;let compareAtPrice = null;if (typeof window.liquidProductData !== 'undefined' && window.liquidProductData) {if (window.liquidProductData.currentPrice && window.liquidProductData.currentPrice > 0) {currentPrice = window.liquidProductData.currentPrice;}if (window.liquidProductData.comparePrice && window.liquidProductData.comparePrice > 0) {compareAtPrice = window.liquidProductData.comparePrice;}}if (!currentPrice && typeof window.ShopifyAnalytics !== 'undefined' && window.ShopifyAnalytics.meta && window.ShopifyAnalytics.meta.product) {const product = window.ShopifyAnalytics.meta.product;if (product.variants && product.variants[0]) {const variant = product.variants[0];if (variant.price && variant.price > 0) {currentPrice = variant.price / 100;}if (variant.compare_at_price && variant.compare_at_price > 0) {compareAtPrice = variant.compare_at_price / 100;}}}if (currentPrice && currentPrice > 0) {return {currentPrice: currentPrice,compareAtPrice: compareAtPrice};}return null;}const productData = fetchProductDataFromPage();let currentPrice, compareAtPrice;if (productData && productData.currentPrice && productData.currentPrice > 0) {currentPrice = productData.currentPrice;compareAtPrice = productData.compareAtPrice || null;} else {currentPrice = config.fallbackCurrentPrice || 24.00;compareAtPrice = config.fallbackComparePrice || 45.00;}const discountPercent = calculateDiscountPercent(compareAtPrice, currentPrice);if (compareAtPrice && compareAtPrice > currentPrice && discountPercent > 0) {discountBadge.textContent = '-' + discountPercent + '%';discountBadge.style.setProperty('display', 'inline-block', 'important');discountBadge.style.setProperty('visibility', 'visible', 'important');comparePriceEl.textContent = formatPrice(compareAtPrice, config.currencySymbol);comparePriceEl.style.setProperty('display', 'inline-block', 'important');comparePriceEl.style.setProperty('visibility', 'visible', 'important');} else {discountBadge.style.setProperty('display', 'none', 'important');comparePriceEl.style.setProperty('display', 'none', 'important');}currentPriceEl.textContent = formatPrice(currentPrice, config.currencySymbol);if (config.showCartBadge && config.cartDiscountPercent > 0) {const cartFinalPrice = calculateCartPrice(currentPrice, config.cartDiscountPercent);const cartBadgeText = config.cartDiscountMessage + ' ' + config.cartDiscountPercent + '% ' + config.cartDiscountSuffix + ' ' + formatPrice(cartFinalPrice, config.currencySymbol);cartBadgeEl.textContent = cartBadgeText;} else {cartBadgeEl.classList.add('hidden');}}if (document.readyState === 'loading') {document.addEventListener('DOMContentLoaded', initDynamicPriceBadges);} else {initDynamicPriceBadges();}let forcedDisplayInterval = null;let forceAttempts = 0;const MAX_FORCE_ATTEMPTS = 6;function forceDisplayPersistent() {forceAttempts++;const discountBadge = document.getElementById('discount-badge');const comparePriceEl = document.getElementById('compare-price');if (!discountBadge || !comparePriceEl) return;if (window.liquidProductData && window.liquidProductData.comparePrice && window.liquidProductData.comparePrice > window.liquidProductData.currentPrice) {const currentDisplay = window.getComputedStyle(discountBadge).display;const compareDisplay = window.getComputedStyle(comparePriceEl).display;if (currentDisplay !== 'none' && compareDisplay !== 'none') {if (forcedDisplayInterval) {clearInterval(forcedDisplayInterval);forcedDisplayInterval = null;}return;}if (currentDisplay === 'none' || compareDisplay === 'none') {discountBadge.style.setProperty('display', 'inline-block', 'important');comparePriceEl.style.setProperty('display', 'inline-block', 'important');}}if (forceAttempts >= MAX_FORCE_ATTEMPTS && forcedDisplayInterval) {clearInterval(forcedDisplayInterval);forcedDisplayInterval = null;}}setTimeout(function() {forcedDisplayInterval = setInterval(forceDisplayPersistent, 200);}, 100);function updatePricesFromVariant(variant) {if (window.liquidProductData && window.liquidProductData.variants) {const liquidVariant = window.liquidProductData.variants.find(function(v) { return v.id === variant.id; });if (liquidVariant) {variant = liquidVariant;}}let currentPrice = null;let compareAtPrice = null;if (variant.price) {currentPrice = typeof variant.price === 'number' ? variant.price : variant.price / 100;}if (variant.comparePrice) {compareAtPrice = variant.comparePrice;} else if (variant.compare_at_price && variant.compare_at_price > 0) {compareAtPrice = variant.compare_at_price / 100;}if (window.liquidProductData) {window.liquidProductData.currentPrice = currentPrice;window.liquidProductData.comparePrice = compareAtPrice;}initDynamicPriceBadges();}document.addEventListener('variant:change', function(event) {if (event.detail && event.detail.variant) {updatePricesFromVariant(event.detail.variant);}});document.addEventListener('variantChange', function(event) {if (event.detail && event.detail.variant) {updatePricesFromVariant(event.detail.variant);}});document.body.addEventListener('change', function(event) {if (event.target.matches('select[name=\"id\"], input[name=\"id\"], input[type=\"radio\"][name*=\"option\"]')) {setTimeout(function() {let selectedVariant = null;if (window.product && window.product.selected_or_first_available_variant) {selectedVariant = window.product.selected_or_first_available_variant;}if (!selectedVariant) {const variantIdInput = document.querySelector('select[name=\"id\"], input[name=\"id\"]');if (variantIdInput) {const variantId = parseInt(variantIdInput.value);if (window.ShopifyAnalytics && window.ShopifyAnalytics.meta && window.ShopifyAnalytics.meta.product) {const product = window.ShopifyAnalytics.meta.product;if (product.variants) {selectedVariant = product.variants.find(function(v) { return v.id === variantId; });}}}}if (selectedVariant) {updatePricesFromVariant(selectedVariant);}}, 100);}});</script>",
  "lastVariableGeneration": { "$date": "2025-10-27T16:00:00.000Z" },
  "isModernTemplate": true,
  "templateCode": "<!-- MODULE: Dynamic Price Badges --><div class=\"dynamic-price-module\"><div class=\"product-price-badges\"><div class=\"product-top-line\"><span class=\"product-discount\" id=\"discount-badge\"></span><span class=\"product-old\" id=\"compare-price\"></span><span class=\"product-new\" id=\"current-price\"></span></div><div class=\"product-cart-badge\" id=\"cart-badge\"></div></div></div><!-- Inject product data via Liquid as JavaScript variable (AFTER HTML) --><script>window.liquidProductData = {currentPrice: {{ product.selected_or_first_available_variant.price | divided_by: 100.0 }},comparePrice: {% if product.selected_or_first_available_variant.compare_at_price %}{{ product.selected_or_first_available_variant.compare_at_price | divided_by: 100.0 }}{% else %}null{% endif %},variants: [{% for variant in product.variants %}{id: {{ variant.id }},price: {{ variant.price | divided_by: 100.0 }},comparePrice: {% if variant.compare_at_price %}{{ variant.compare_at_price | divided_by: 100.0 }}{% else %}null{% endif %}}{% unless forloop.last %},{% endunless %}{% endfor %}]};if (typeof initDynamicPriceBadges === 'function') {initDynamicPriceBadges();}</script><style>* {box-sizing: border-box;margin: 0;padding: 0;}.dynamic-price-module {width: 100%;font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;}.product-price-badges {max-width: 320px;width: 100%;}.product-top-line {display: flex;align-items: center;gap: 8px;flex-wrap: nowrap;}.product-discount {background-color: ${badge_color};color: #fff;font-weight: 600;padding: 4px 8px;border-radius: 5px;font-size: 12px;flex-shrink: 0;}.product-old {color: #a0a0a0;text-decoration: line-through;font-size: 14px;flex-shrink: 0;}.product-new {color: #000;font-weight: 700;font-size: 18px;}.product-cart-badge {background-color: ${badge_color};color: #fff;font-weight: 600;padding: 6px 10px;border-radius: 6px;font-size: 13px;margin-top: 8px;text-align: left;line-height: 1;white-space: nowrap;display: inline-block;}.product-cart-badge.hidden {display: none;}@media (max-width: 480px) {.product-top-line {gap: 5px;}.product-discount {font-size: 11px;padding: 3px 6px;}.product-old {font-size: 12px;}.product-new {font-size: 15px;}.product-cart-badge {font-size: 12px;padding: 5px 8px;border-radius: 5px;}}</style><script>function initDynamicPriceBadges() {const config = {cartDiscountPercent: ${cart_discount_percent},cartDiscountMessage: '${cart_discount_message}',cartDiscountSuffix: '${cart_discount_suffix}',showCartBadge: ${show_cart_badge},currencySymbol: '${currency_symbol}',fallbackCurrentPrice: ${fallback_current_price},fallbackComparePrice: ${fallback_compare_price},discountBadgeId: 'discount-badge',comparePriceId: 'compare-price',currentPriceId: 'current-price',cartBadgeId: 'cart-badge'};const discountBadge = document.getElementById(config.discountBadgeId);const comparePriceEl = document.getElementById(config.comparePriceId);const currentPriceEl = document.getElementById(config.currentPriceId);const cartBadgeEl = document.getElementById(config.cartBadgeId);if (!discountBadge || !comparePriceEl || !currentPriceEl || !cartBadgeEl) {console.error('Price badge elements not found');return;}function formatPrice(price, currency = config.currencySymbol) {return currency + price.toFixed(2);}function calculateDiscountPercent(comparePrice, currentPrice) {if (!comparePrice || comparePrice <= 0 || currentPrice >= comparePrice) {return 0;}const discount = ((comparePrice - currentPrice) / comparePrice) * 100;return Math.round(discount);}function calculateCartPrice(currentPrice, cartDiscountPercent) {const finalPrice = currentPrice * (1 - cartDiscountPercent / 100);return finalPrice;}function fetchProductDataFromPage() {let currentPrice = null;let compareAtPrice = null;if (typeof window.liquidProductData !== 'undefined' && window.liquidProductData) {if (window.liquidProductData.currentPrice) {currentPrice = window.liquidProductData.currentPrice;}if (window.liquidProductData.comparePrice) {compareAtPrice = window.liquidProductData.comparePrice;}}if (!currentPrice && typeof window.ShopifyAnalytics !== 'undefined' && window.ShopifyAnalytics.meta && window.ShopifyAnalytics.meta.product) {const product = window.ShopifyAnalytics.meta.product;if (product.variants && product.variants[0]) {const variant = product.variants[0];if (variant.price) {currentPrice = variant.price / 100;}if (variant.compare_at_price && variant.compare_at_price > 0) {compareAtPrice = variant.compare_at_price / 100;}}}if (currentPrice && currentPrice > 0) {return {currentPrice: currentPrice,compareAtPrice: compareAtPrice};}return null;}const productData = fetchProductDataFromPage();let currentPrice, compareAtPrice;if (productData && productData.currentPrice) {currentPrice = productData.currentPrice;compareAtPrice = productData.compareAtPrice || null;} else {currentPrice = config.fallbackCurrentPrice || 24.00;compareAtPrice = config.fallbackComparePrice || 45.00;}const discountPercent = calculateDiscountPercent(compareAtPrice, currentPrice);if (compareAtPrice && compareAtPrice > currentPrice && discountPercent > 0) {discountBadge.textContent = '-' + discountPercent + '%';discountBadge.style.setProperty('display', 'inline-block', 'important');discountBadge.style.setProperty('visibility', 'visible', 'important');comparePriceEl.textContent = formatPrice(compareAtPrice, config.currencySymbol);comparePriceEl.style.setProperty('display', 'inline-block', 'important');comparePriceEl.style.setProperty('visibility', 'visible', 'important');} else {discountBadge.style.setProperty('display', 'none', 'important');comparePriceEl.style.setProperty('display', 'none', 'important');}currentPriceEl.textContent = formatPrice(currentPrice, config.currencySymbol);if (config.showCartBadge && config.cartDiscountPercent > 0) {const cartFinalPrice = calculateCartPrice(currentPrice, config.cartDiscountPercent);const cartBadgeText = config.cartDiscountMessage + ' ' + config.cartDiscountPercent + '% ' + config.cartDiscountSuffix + ' ' + formatPrice(cartFinalPrice, config.currencySymbol);cartBadgeEl.textContent = cartBadgeText;} else {cartBadgeEl.classList.add('hidden');}}if (document.readyState === 'loading') {document.addEventListener('DOMContentLoaded', initDynamicPriceBadges);} else {initDynamicPriceBadges();}let forcedDisplayInterval = null;let forceAttempts = 0;const MAX_FORCE_ATTEMPTS = 6;function forceDisplayPersistent() {forceAttempts++;const discountBadge = document.getElementById('discount-badge');const comparePriceEl = document.getElementById('compare-price');if (!discountBadge || !comparePriceEl) return;if (window.liquidProductData && window.liquidProductData.comparePrice && window.liquidProductData.comparePrice > window.liquidProductData.currentPrice) {const currentDisplay = window.getComputedStyle(discountBadge).display;const compareDisplay = window.getComputedStyle(comparePriceEl).display;if (currentDisplay !== 'none' && compareDisplay !== 'none') {if (forcedDisplayInterval) {clearInterval(forcedDisplayInterval);forcedDisplayInterval = null;}return;}if (currentDisplay === 'none' || compareDisplay === 'none') {discountBadge.style.setProperty('display', 'inline-block', 'important');comparePriceEl.style.setProperty('display', 'inline-block', 'important');}}if (forceAttempts >= MAX_FORCE_ATTEMPTS && forcedDisplayInterval) {clearInterval(forcedDisplayInterval);forcedDisplayInterval = null;}}setTimeout(function() {forcedDisplayInterval = setInterval(forceDisplayPersistent, 200);}, 100);function updatePricesFromVariant(variant) {if (window.liquidProductData && window.liquidProductData.variants) {const liquidVariant = window.liquidProductData.variants.find(function(v) { return v.id === variant.id; });if (liquidVariant) {variant = liquidVariant;}}let currentPrice = null;let compareAtPrice = null;if (variant.price) {currentPrice = typeof variant.price === 'number' ? variant.price : variant.price / 100;}if (variant.comparePrice) {compareAtPrice = variant.comparePrice;} else if (variant.compare_at_price && variant.compare_at_price > 0) {compareAtPrice = variant.compare_at_price / 100;}if (window.liquidProductData) {window.liquidProductData.currentPrice = currentPrice;window.liquidProductData.comparePrice = compareAtPrice;}initDynamicPriceBadges();}document.addEventListener('variant:change', function(event) {if (event.detail && event.detail.variant) {updatePricesFromVariant(event.detail.variant);}});document.addEventListener('variantChange', function(event) {if (event.detail && event.detail.variant) {updatePricesFromVariant(event.detail.variant);}});document.body.addEventListener('change', function(event) {if (event.target.matches('select[name=\"id\"], input[name=\"id\"], input[type=\"radio\"][name*=\"option\"]')) {setTimeout(function() {let selectedVariant = null;if (window.product && window.product.selected_or_first_available_variant) {selectedVariant = window.product.selected_or_first_available_variant;}if (!selectedVariant) {const variantIdInput = document.querySelector('select[name=\"id\"], input[name=\"id\"]');if (variantIdInput) {const variantId = parseInt(variantIdInput.value);if (window.ShopifyAnalytics && window.ShopifyAnalytics.meta && window.ShopifyAnalytics.meta.product) {const product = window.ShopifyAnalytics.meta.product;if (product.variants) {selectedVariant = product.variants.find(function(v) { return v.id === variantId; });}}}}if (selectedVariant) {updatePricesFromVariant(selectedVariant);}}, 100);}});</script>",
  "variables": [
    { "name": "cart_discount_percent", "label": "Cart Discount Percent", "type": "number", "defaultValue": "10" },
    { "name": "cart_discount_message", "label": "Cart Discount Message", "type": "text", "defaultValue": "Extra" },
    { "name": "cart_discount_suffix", "label": "Cart Discount Suffix", "type": "text", "defaultValue": "Off in Cart" },
    { "name": "show_cart_badge", "label": "Show Cart Badge", "type": "text", "defaultValue": "true" },
    { "name": "currency_symbol", "label": "Currency Symbol", "type": "text", "defaultValue": "$" },
    { "name": "fallback_current_price", "label": "Fallback Current Price (Demo)", "type": "number", "defaultValue": "24" },
    { "name": "fallback_compare_price", "label": "Fallback Compare Price (Demo)", "type": "number", "defaultValue": "45" },
    { "name": "badge_color", "label": "Badge Background Color", "type": "color", "defaultValue": "#c73225" }
  ],
  "popular": false
}
